var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function i(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}();define("NumJS/Array",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_TYPE_INSTANCE=Float32Array,t.zeros=function(e,a){return void 0===a&&(a=t.DEFAULT_TYPE_INSTANCE),new a(e)},t.fill=function(e,t){for(var a=0,i=e.length;a<i;++a)e[a]=t;return e},t.prod=function(e){for(var t=1,a=0,i=e.length;a<i;++a)t*=e[a];return t},t.sum=function(e){for(var t=0,a=0,i=e.length;a<i;++a)t+=e[a];return t},t.add=function(e,t){if(e.length===t.length){for(var a=0,i=e.length;a<i;++a)e[a]+=t[a];return e}throw new TypeError("Bad input shapes "+e.length+" "+t.length)},t.addConst=function(e,t){for(var a=0,i=e.length;a<i;++a)e[a]+=t;return e},t.sub=function(e,t){if(e.length===t.length){for(var a=0,i=e.length;a<i;++a)e[a]-=t[a];return e}throw new TypeError("Bad input shape "+e.length+" "+t.length)},t.subConst=function(e,t){for(var a=0,i=e.length;a<i;++a)e[a]-=t;return e},t.mul=function(e,t){if(e.length===t.length){for(var a=0,i=e.length;a<i;++a)e[a]*=t[a];return e}throw new TypeError("Bad input shape "+e.length+" "+t.length)},t.mulByConst=function(e,t){for(var a=0,i=e.length;a<i;++a)e[a]*=t;return e},t.div=function(e,t){if(e.length===t.length){for(var a=0,i=e.length;a<i;++a)e[a]/=t[a];return e}throw new TypeError("Bad input shape "+e.length+" "+t.length)},t.divByConst=function(e,t){for(var a=0,i=e.length;a<i;++a)e[a]/=t;return e},t.addScaled=function(e,t,a){if(e.length===t.length){for(var i=0,o=e.length;i<o;++i)e[i]+=a*t[i];return e}throw new TypeError("Bad input shape "+e.length+" "+t.length)}}),define("NumJS/MinMax",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.max=function(e){for(var t=Number.NEGATIVE_INFINITY,a=0,i=e.length;a<i;++a)e[a]>t&&(t=e[a]);return t},t.argmax=function(e){for(var t=Number.NEGATIVE_INFINITY,a=0,i=0,o=e.length;i<o;++i)e[i]>t&&(t=e[i],a=i);return a},t.maxn=function(e,t){return t=t||3,e.slice(0).sort(function(e,t){return t-e}).slice(0,t)},t.argmaxn=function(e,t){t=t||3;for(var a=e.length,i=new Uint32Array(a),o=0;o<a;++o)i[o]=o;return i.sort(function(t,a){return e[a]-e[t]}).slice(0,t)},t.maxmin=function(e){if(0===e.length)return{};for(var t=e[0],a=e[0],i=0,o=0,r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r],i=r),e[r]<a&&(a=e[r],o=r);return{maxi:i,maxv:t,mini:o,minv:a,dv:t-a}}}),define("NumJS/Random",["require","exports"],function(e,t){"use strict";function a(){if(i)return i=!1,o;var e=2*Math.random()-1,t=2*Math.random()-1,r=e*e+t*t;if(0==r||r>1)return a();var n=Math.sqrt(-2*Math.log(r)/r);return o=t*n,i=!0,e*n}Object.defineProperty(t,"__esModule",{value:!0});var i=!1,o=0;t.gaussRandom=a,t.randf=function(e,t){return Math.random()*(t-e)+e},t.randi=function(e,t){return Math.floor(Math.random()*(t-e)+e)},t.randn=function(e,t){return e+a()*t},t.randperm=function(e){for(var t,a=e,i=0,o=[],r=0;r<e;++r)o[r]=r;for(;a--;)i=Math.floor(Math.random()*(a+1)),t=o[a],o[a]=o[i],o[i]=t;return o}}),define("NumJS/Utils",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clip=function(e,t,a){return Math.max(Math.min(e,a),t)},t.mod=function(e,t){return(e%t+t)%t},t.tanh=function(e){var t=Math.exp(2*e);return(t-1)/(t+1)}}),define("NumJS/_module",["require","exports","NumJS/Array","NumJS/MinMax","NumJS/Random","NumJS/Utils"],function(e,t,a,i,o,r){"use strict";function n(e){for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a])}Object.defineProperty(t,"__esModule",{value:!0}),n(a),n(i),n(o),n(r)}),define("Net/Vol",["require","exports","NumJS/_module"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,o){this.sx=e,this.sy=t,this.depth=i;var r=this.sx*this.sy*this.depth;if(this.w=a.zeros(r),void 0===o)for(var n=Math.sqrt(1/r),s=0;s<r;++s)this.w[s]=a.randn(0,n);else 0!==o&&a.fill(this.w,o)}return e.fromArray=function(t){var a=new e(1,1,t.length,0);return a.w.set(t),a},e.prototype.clone=function(){var t=new e(this.sx,this.sy,this.depth,0);return t.w.set(this.w),t},e.prototype.cloneAndZero=function(){return new e(this.sx,this.sy,this.depth,0)},e.prototype.get=function(e,t,a){var i=(this.sx*t+e)*this.depth+a;return this.w[i]},e.prototype.set=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;this.w[o]=i},e.prototype.add=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;return this.w[o]+=i,this},e.prototype.sub=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;return this.w[o]-=i,this},e.prototype.mul=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;return this.w[o]*=i,this},e.prototype.div=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;return this.w[o]/=i,this},e.prototype.get_grad=function(e,t,a){var i=(this.sx*t+e)*this.depth+a;return this.dw[i]},e.prototype.set_grad=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;this.dw[o]=i},e.prototype.add_grad=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;this.dw[o]+=i},e.prototype.sub_grad=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;this.dw[o]-=i},e.prototype.mul_grad=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;this.dw[o]*=i},e.prototype.div_grad=function(e,t,a,i){var o=(this.sx*t+e)*this.depth+a;this.dw[o]/=i},e.prototype.roll=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0);for(var o=this.clone(),r=0,n=o.depth;r<n;++r)for(var s=0,p=o.sx;s<p;++s)for(var l=0,u=o.sy;l<u;++l){var d=this.get(a.mod(s+e,this.sx),a.mod(l+t,this.sy),a.mod(r+i,this.depth));o.set(s,l,r,d)}return o},e.prototype.zoom=function(t,a,i){void 0===t&&(t=1),void 0===a&&(a=1),void 0===i&&(i=1);for(var o=new e(Math.round(this.sx*t),Math.round(this.sy*a),Math.round(this.depth*i),0),r=0,n=o.depth;r<n;++r)for(var s=0,p=o.sx;s<p;++s)for(var l=0,u=o.sy;l<u;++l){for(var d=0,m=Math.ceil(1/t),h=Math.ceil(1/a),f=Math.ceil(1/i),y=Math.ceil(s/t),_=Math.ceil(l/a),c=Math.ceil(r/i),v=Math.min(y+m,this.sx),g=Math.min(_+h,this.sy),w=Math.min(c+f,this.depth),x=y;x<v;x++)for(var P=_;P<g;P++)for(var N=c;N<w;N++){var b=this.get(x,P,N);o.add(s,l,r,b),d++}o.div(s,l,r,d)}return o},e.prototype.toJSON=function(){var e={};return e.sx=this.sx,e.sy=this.sy,e.depth=this.depth,e.w=this.w,e},e.fromJSON=function(t){var a=new e(t.sx,t.sy,t.depth,0);return a.w.set(t.w),a},e}();t.default=i}),define("ImgJS/Image",["require","exports","es6-shim","Net/Vol","NumJS/_module"],function(e,t,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.src=e,this.canvas=document.createElement("canvas"),this.image=document.createElement("img")}return e.prototype.set=function(e){return this.data=e.data,this.image.width=e.width,this.image.height=e.height,this},e.prototype.load=function(){var e=this;return new a.Promise(function(t,a){var i=e.canvas.getContext("2d");e.image.onload=function(){i.imageSmoothingEnabled=!1,e.canvas.width=e.image.width,e.canvas.height=e.image.height,i.drawImage(e.image,0,0);var a=i.getImageData(0,0,e.image.width,e.image.height);e.data=a.data,t(e.data)},e.image.src=e.src+"?"+(new Date).getTime(),e.image.setAttribute("crossOrigin","")})},e.prototype.render=function(e){void 0===e&&(e=this.canvas,document.body.appendChild(e)),e.width=this.image.width,e.height=this.image.height;var t=e.getContext("2d");t.imageSmoothingEnabled=!1;var a=t.getImageData(0,0,this.image.width,this.image.height);a.data.set(this.data),t.putImageData(a,0,0)},e.fromMean=function(t,a,i,o){return void 0===a&&(a=0),void 0===i&&(i=1),void 0===o&&(o=!1),e.fromVol(t,0,[0,1,2],i,o)},e.fromFilter=function(t,a,i,o){return void 0===a&&(a=0),void 0===i&&(i=1),void 0===o&&(o=!0),e.fromVol(t,0,a,i,o)},e.fromVol=function(t,a,r,n,s,p){void 0===r&&(r=[2,1,0]),void 0===n&&(n=1),void 0===s&&(s=!1),void 0===p&&(p=255);var l=new e;a=void 0!==a?a:[0,0,0];for(var u=t.sx,d=t.sy,m=u*d*4,h=o.maxmin(t.w),f=r?r instanceof Array?r[0]:+r:0,y=r?r instanceof Array?r[1]:+r:0,_=r?r instanceof Array?r[2]:+r:0,c=new Uint8ClampedArray(m),v=0;v<d;v++)for(var g=0;g<u;g++){var w=4*(v*u+g),x=a?a instanceof i.default?a.get(g,v,f):+a[f]:0,P=a?a instanceof i.default?a.get(g,v,y):+a[y]:0,N=a?a instanceof i.default?a.get(g,v,_):+a[_]:0,b=t.get(g,v,f),L=t.get(g,v,y),S=t.get(g,v,_);s&&(b=Math.floor((t.get(g,v,f)-h.minv)/h.dv*255),L=Math.floor((t.get(g,v,y)-h.minv)/h.dv*255),S=Math.floor((t.get(g,v,_)-h.minv)/h.dv*255)),c[w+0]=b+x,c[w+1]=L+P,c[w+2]=S+N,c[w+3]=p}return l.image.width=u,l.image.height=d,l.data=c,l},e.prototype.toVol=function(e,t){void 0===t&&(t=[2,1,0]),e=void 0!==e?e:[0,0,0];for(var a=this.image.width,o=this.image.height,r=t[0],n=t[1],s=t[2],p=new i.default(a,o,3,0),l=0;l<o;l++)for(var u=0;u<a;u++){var d=4*(l*a+u),m=e instanceof i.default?e.get(u,l,r):+e[r],h=e instanceof i.default?e.get(u,l,n):+e[n],f=e instanceof i.default?e.get(u,l,s):+e[s];p.set(u,l,r,this.data[d+0]-m),p.set(u,l,n,this.data[d+1]-h),p.set(u,l,s,this.data[d+2]-f)}return p},e}();t.default=r}),define("Parser/TextParser",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.fetch=function(e){var t=new Request(e);return fetch(t).then(function(e){return e.text()})},e.prototype.parse=function(e){var t=this;return this.fetch(e).then(function(e){return t.parseString(e)})},e}();t.TextParser=a}),define("Parser/PrototxtParser",["require","exports","Parser/TextParser"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.parseString=function(e){return this.parsePrototxt(e)},t.prototype.parsePrototxt=function(e,t){void 0===t&&(t=0);var a,i={};if(0==t)var o=/(?:^|\n)(\w+):\s"*([\w/.]+)"*/gi,r=/(?:^|\n)(\w+)\s\{([\S\s]*?)\n\}/gi;else var n="(?:^|\\n)\\s{"+t+"}",s="(\\w+)",o=new RegExp(n+s+'\\s*:\\s*"*([\\w/.]+)"*',"gi"),r=new RegExp(n+s+"\\s*\\{\\s*\\n([\\s\\S]*?)\\n\\s{"+t+"}\\}","gi");for(;a=o.exec(e);){var s=a[1],p=a[2];void 0!==i[s]?Array.isArray(i[s])?i[s].push(p):(i[s]=[i[s]],i[s].push(p)):i[a[1]]=p}for(;a=r.exec(e);){var s=a[1],p=this.parsePrototxt(a[2],t+2);void 0!==i[s]?Array.isArray(i[s])?i[s].push(p):(i[s]=[i[s]],i[s].push(p)):i[s]=p}return i},t}(a.TextParser);t.default=i}),define("Net/ILayer",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("Net/Net",["require","exports","d3","NumJS/_module"],function(e,t,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.getLayer=function(e){return this.layers.get(e)},e.prototype.setInputDimensions=function(e,t,a){void 0===a&&(a=3),this.layerIterator(function(i,o,r){0===o?(i.in_sx=e,i.in_sy=t,i.in_depth=a,i.updateDimensions()):i.updateDimensions(r)})},e.prototype.layerIterator=function(e,t){var i=this;void 0===t&&(t={});var o,r=[],n=[],s=0,p=a.set();void 0===t.reverse||!1===t.reverse?(o=t.start?this.layers.get(t.start):this.layers.get("data"),n=this.edges):(o=t.start?this.layers.get(t.start):this.layers.values()[this.layers.size()-1],n=this.edges.map(function(e){return{from:e.to,to:e.from}}));var l=a.map(a.nest().key(function(e){return e.from}).entries(n),function(e){return e.key}),u=a.map(a.nest().key(function(e){return e.to}).entries(n),function(e){return e.key});for(r.push(o);r.length;){var d=r.pop();p.add(d.name);var m=u.get(d.name);if(e(d,s++,void 0===m?void 0:m.values.map(function(e){return i.layers.get(e.from)})),t.end&&d.name===t.end)break;var h=l.get(d.name);h&&h.values.filter(function(e){return!p.has(e.to)}).forEach(function(e){var t=u.get(e.to);0===(void 0===t?[]:t.values.filter(function(e){return!p.has(e.from)})).length&&r.push(i.layers.get(e.to))})}},e.prototype.forward=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i={});var o,r=a.map();return this.layerIterator(function(a,i,n){o=void 0===n?e:n.length>1?n.map(function(e){return r.get(e.name)}):r.get(n[0].name),o=a.forward(o,t),r.set(a.name,o)},i),o},e.prototype.backward=function(e,t){void 0===t&&(t={}),t.reverse=!0;var a;return this.layerIterator(function(t,i,o){void 0!==e&&0===i?a=t.backward(e):t.backward()},t),a},e.prototype.debugStructure=function(){var e=0,t=a.format("s"),o=a.format(",d"),r=0;this.layerIterator(function(t,a,n){var s=i.sum(t.getNumParameters()),p="";p+=t.getOutputShape().join("x")+" :: ",p+=t.getDescription().join(" "),s&&(e+=s,p+=" => "+o(s)+" parameters"),r+=1,console.log(p)}),console.log("---"),console.log("Total number of layers "+o(r)),console.log("Total number of params "+o(e)+" (memory: "+t(4*e)+"b): ")},e}();t.default=o}),define("Net/Utils",["require","exports","NumJS/_module"],function(e,t,a){"use strict";function i(e,t){for(var a=0,i=e.length;a<i;a++)if(e[a]===t)return!0;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.weightedSample=function(e,t){for(var i=a.randf(0,1),o=0,r=0,n=e.length;r<n;r++)if(o+=t[r],i<o)return e[r]},t.getopt=function(e,t,a){if(void 0===e&&(e={}),"string"==typeof t)return void 0!==e[t]?e[t]:a;var i=a;return t.forEach(function(t){i=void 0!==e[t]?e[t]:i}),i},t.assert=function(e,t){if(!e){if(t=t||"Assertion failed","undefined"!=typeof Error)throw new Error(t);throw t}},t.arrContains=i,t.arrUnique=function(e){for(var t=[],a=0,o=e.length;a<o;a++)i(t,e[a])||t.push(e[a]);return t}}),define("Net/Layers/BaseLayer",["require","exports","NumJS/_module"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.in_depth=1,this.in_sy=1,this.in_sx=1,this.out_depth=1,this.out_sy=1,this.out_sx=1,this.name=void 0!==e.name?e.name:"",this.input=void 0!==e.input?e.input:void 0,this.output=void 0!==e.output?e.output:void 0,e.pred||(this.in_sx=e.in_sx,this.in_sy=e.in_sy,this.in_depth=e.in_depth)}return e.prototype.updateDimensions=function(e){e&&(this.in_sx=e[0].out_sx,this.in_sy=e[0].out_sy,this.in_depth=e[0].out_depth),this.out_sx=this.in_sx,this.out_sy=this.in_sy,this.out_depth=this.in_depth},e.prototype.resetGradient=function(){if(this.in_act instanceof Array)for(var e=0;e<this.in_act.length;e++)this.in_act[e].dw=a.zeros(this.in_act[e].w.length);else this.in_act.dw=a.zeros(this.in_act.w.length)},e.prototype.getNumParameters=function(){return[0,0]},e.prototype.getOutputShape=function(){return this.in_sy&&this.in_sx?[this.in_depth,this.in_sy,this.in_sx]:[this.in_depth]},e.prototype.getDescription=function(){return[this.layer_type.toUpperCase(),this.name]},e.prototype.getParamsAndGrads=function(){return[]},e.prototype.toJSON=function(){var e={};return e.out_depth=this.out_depth,e.out_sx=this.out_sx,e.out_sy=this.out_sy,e.layer_type=this.layer_type,e.name=this.name,e.output=this.output,e.input=this.input,e},e.prototype.fromJSON=function(e){this.out_depth=e.out_depth,this.out_sx=e.out_sx,this.out_sy=e.out_sy,this.layer_type=e.layer_type,this.name=e.name,this.output=e.output,this.input=e.input},e}();t.default=i}),define("Net/Layers/ConcatLayer",["require","exports","Net/Layers/BaseLayer","Net/Vol","Net/Utils","NumJS/_module"],function(e,t,a,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="concat",a.axis=o.getopt(t,["axis"],1),a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient();var a=new i.default(this.out_sx,this.out_sy,this.out_depth,0),o=0;if(0===this.axis)for(var r=a.w,n=0;n<e.length;n++)r.set(e[n].w,o),o+=e[n].w.length;else for(var s=0;s<e.length;s++){for(var p=e[s],l=0;l<p.depth;l++)for(var u=0;u<p.sx;u++)for(var d=0;d<p.sy;d++)a.set(u,d,l+o,p.get(u,d,l));o+=p.depth}return this.out_act=a,this.out_act},t.prototype.backward=function(){var e=this.in_act,t=this.out_act,a=0;if(0===this.axis)for(var i=t.dw,o=0;o<e.length;o++){p=e[o].dw;a+=(p=r.add(p,i.slice(a,a+p.length))).length}else for(var o=0,n=e.length;o<n;++o){for(var s=e[o],p=e[o].dw,l=0,u=s.depth;l<u;++l)for(var d=0,m=s.sx;d<m;++d)for(var h=0,f=s.sy;h<f;++h)s.add_grad(d,h,l,t.get_grad(d,h,l+a));a+=s.depth}},t.prototype.updateDimensions=function(e){e&&(0==this.axis?(this.in_sx=e[0].in_sx,this.in_sy=e[0].in_sy,this.in_depth=e[0].in_depth):(this.in_sx=e[0].in_sx,this.in_sy=e[0].in_sy,this.in_depth=r.sum(e.map(function(e){return e.out_depth})))),this.out_sx=this.in_sx,this.out_sy=this.in_sy,this.out_depth=this.in_depth},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.axis=this.axis,t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.axis=t.axis},t}(a.default);t.default=n}),define("Net/Layers/ConvLayer",["require","exports","Net/Layers/BaseLayer","Net/Vol","Net/Utils","NumJS/_module"],function(e,t,a,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var a=e.call(this,t||{})||this;a.layer_type="conv",a.out_depth=t.filters,a.sx=t.sx,a.sy=o.getopt(t,["sy"],a.sx),a.stride=o.getopt(t,["stride"],1),a.pad=o.getopt(t,["pad"],0),a.conv_groups=o.getopt(t,["group"],1),a.l1_decay_mul=o.getopt(t,["l1_decay_mul"],0),a.l2_decay_mul=o.getopt(t,["l2_decay_mul"],1),a.updateDimensions(t.pred);var r=o.getopt(t,["bias_pref"],0);a.biases=new i.default(1,1,a.out_depth,r),a.filters=[];for(var n=Math.ceil(a.in_depth/a.conv_groups),s=0;s<a.out_depth;++s)a.filters.push(new i.default(a.sx,a.sy,n,0));return a}return __extends(t,e),t.prototype.resetGradient=function(){e.prototype.resetGradient.call(this);for(var t=0;t<this.out_depth;++t)this.filters[t].dw=r.zeros(this.filters[t].w.length);this.biases.dw=r.zeros(this.out_depth)},t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient();for(var a=new i.default(0|this.out_sx,0|this.out_sy,0|this.out_depth,0),o=0|e.sx,r=0|e.sy,n=0|this.stride,s=Math.ceil(this.out_depth/this.conv_groups),p=0;p<this.conv_groups;++p)for(var l=p*s,u=l+s,d=l;d<u;++d)for(var m=this.filters[d],h=0|-this.pad,f=0|-this.pad,y=0;y<this.out_sy;f+=n,++y){h=0|-this.pad;for(var _=0;_<this.out_sx;h+=n,++_){for(var c=0,v=0;v<m.sy;++v)for(var g=f+v,w=0;w<m.sx;++w){var x=h+w;if(g>=0&&g<r&&x>=0&&x<o)for(var P=0;P<m.depth;++P)c+=m.w[(m.sx*v+w)*m.depth+P]*e.w[(o*g+x)*e.depth*(p+1)+P]}c+=this.biases.w[d],a.set(_,y,d,c)}}return this.out_act=a,this.out_act},t.prototype.backward=function(){for(var e=this.in_act,t=0|e.sx,a=0|e.sy,i=0|this.stride,o=Math.ceil(this.out_depth/this.conv_groups),r=0;r<this.conv_groups;++r)for(var n=r*o,s=n+o,p=n;p<s;++p)for(var l=this.filters[p],u=0|-this.pad,d=0|-this.pad,m=0;m<this.out_sy;d+=i,++m){u=0|-this.pad;for(var h=0;h<this.out_sx;u+=i,++h){for(var f=this.out_act.get_grad(h,m,p),y=0;y<l.sy;++y)for(var _=d+y,c=0;c<l.sx;++c){var v=u+c;if(_>=0&&_<a&&v>=0&&v<t)for(var g=0;g<l.depth;++g){var w=(t*_+v)*e.depth*(r+1)+g,x=(l.sx*y+c)*l.depth+g;l.dw[x]+=e.w[w]*f,e.dw[w]+=l.w[x]*f}}this.biases.dw[p]+=f}}},t.prototype.getParamsAndGrads=function(){for(var e=[],t=0;t<this.out_depth;t++)e.push({params:this.filters[t].w,grads:this.filters[t].dw,l2_decay_mul:this.l2_decay_mul,l1_decay_mul:this.l1_decay_mul});return e.push({params:this.biases.w,grads:this.biases.dw,l1_decay_mul:0,l2_decay_mul:0}),e},t.prototype.updateDimensions=function(e){e&&(this.in_sx=e[0].out_sx,this.in_sy=e[0].out_sy,this.in_depth=e[0].out_depth);var t=this.getOutputShape();this.out_sx=t[1],this.out_sy=t[2]},t.prototype.getNumParameters=function(){return[Math.ceil(this.in_depth*this.sx*this.sy*this.out_depth/this.conv_groups),this.out_depth]},t.prototype.getOutputShape=function(){return[this.out_depth,Math.round((this.in_sx+2*this.pad-this.sx)/this.stride+1),Math.round((this.in_sy+2*this.pad-this.sy)/this.stride+1)]},t.prototype.getDescription=function(){return e.prototype.getDescription.call(this).concat([[this.out_depth,this.sy,this.sx].join("x")+" Stride "+this.stride+" Pad "+this.pad])},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);t.sx=this.sx,t.sy=this.sy,t.stride=this.stride,t.in_depth=this.in_depth,t.l1_decay_mul=this.l1_decay_mul,t.l2_decay_mul=this.l2_decay_mul,t.pad=this.pad,t.filters=[];for(var a=0;a<this.filters.length;a++)t.filters.push(this.filters[a].toJSON());return t.biases=this.biases.toJSON(),t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.sx=t.sx,this.sy=t.sy,this.stride=t.stride,this.in_depth=t.in_depth,this.filters=[],this.l1_decay_mul=void 0!==t.l1_decay_mul?t.l1_decay_mul:0,this.l2_decay_mul=void 0!==t.l2_decay_mul?t.l2_decay_mul:1,this.pad=void 0!==t.pad?t.pad:0;for(var a=0;a<t.filters.length;a++)this.filters.push(i.default.fromJSON(t.filters[a]));this.biases=i.default.fromJSON(t.biases)},t}(a.default);t.default=n}),define("Net/Layers/DropoutLayer",["require","exports","Net/Layers/BaseLayer","Net/Utils","NumJS/_module"],function(e,t,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="dropout",a.drop_prob=i.getopt(t,["drop_prob"],.5),a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){void 0===t&&(t=!1),this.in_act=e,this.resetGradient(),this.dropped=o.zeros(this.out_sx*this.out_sy*this.out_depth,Int8Array);var a=e.clone(),i=e.w.length;if(t)for(var r=0;r<i;r++)Math.random()<this.drop_prob?(a.w[r]=0,this.dropped[r]=1):a.w[r]*=this.drop_prob;return this.out_act=a,this.out_act},t.prototype.backward=function(){for(var e=this.in_act,t=this.out_act,a=e.w.length,i=0;i<a;i++)1!==this.dropped[i]&&(e.dw[i]+=t.dw[i])},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.drop_prob=this.drop_prob,t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.drop_prob=t.drop_prob},t}(a.default);t.default=r}),define("Net/Layers/FullyConnectedLayer",["require","exports","Net/Layers/BaseLayer","Net/Vol","Net/Utils","NumJS/_module"],function(e,t,a,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var a=e.call(this,t||{})||this;a.layer_type="fc",a.sx=1,a.sy=1,a.conv_groups=1,a.out_depth=void 0!==t.num_neurons?t.num_neurons:t.filters,a.l1_decay_mul=o.getopt(t,["l1_decay_mul"],0),a.l2_decay_mul=o.getopt(t,["l2_decay_mul"],1),a.updateDimensions(t.pred);var r=o.getopt(t,["bias_pref"],0);a.biases=new i.default(1,1,a.out_depth,r),a.filters=[];for(n=0;n<a.out_depth;++n)a.filters.push(new i.default(1,1,a.num_inputs,0));if(void 0!==t.filters)for(var n=0;n<a.out_depth;++n)a.filters[n].w.set(t.filters[n]);return void 0!==t.biases&&a.biases.w.set(t.biases),a}return __extends(t,e),t.prototype.resetGradient=function(){e.prototype.resetGradient.call(this);for(var t=0;t<this.out_depth;++t)this.filters[t].dw=r.zeros(this.filters[t].w.length);this.biases.dw=r.zeros(this.out_depth)},t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient();for(var a=new i.default(1,1,this.out_depth,0),o=e.w,r=0;r<this.out_depth;++r){for(var n=0,s=this.filters[r].w,p=0;p<this.num_inputs;++p)n+=o[p]*s[p];n+=this.biases.w[r],a.w[r]=n}return this.out_act=a,this.out_act},t.prototype.backward=function(){for(var e=this.in_act,t=0;t<this.out_depth;++t){for(var a=this.filters[t],i=this.out_act.dw[t],o=0;o<this.num_inputs;++o)e.dw[o]+=a.w[o]*i,a.dw[o]+=e.w[o]*i;this.biases.dw[t]+=i}},t.prototype.getParamsAndGrads=function(){for(var e=[],t=0;t<this.out_depth;++t)e.push({params:this.filters[t].w,grads:this.filters[t].dw,l1_decay_mul:this.l1_decay_mul,l2_decay_mul:this.l2_decay_mul});return e.push({params:this.biases.w,grads:this.biases.dw,l1_decay_mul:0,l2_decay_mul:0}),e},t.prototype.updateDimensions=function(e){e&&(this.in_sx=e[0].out_sx,this.in_sy=e[0].out_sy,this.in_depth=e[0].out_depth),this.num_inputs=this.in_sx*this.in_sy*this.in_depth},t.prototype.getNumParameters=function(){return[this.in_depth*this.in_sx*this.in_sy*this.out_depth,this.out_depth]},t.prototype.getOutputShape=function(){return[this.out_depth,1,1]},t.prototype.getDescription=function(){return[this.layer_type.toUpperCase(),this.name,this.out_depth.toString()]},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);t.num_inputs=this.num_inputs,t.l1_decay_mul=this.l1_decay_mul,t.l2_decay_mul=this.l2_decay_mul,t.filters=[];for(var a=0;a<this.filters.length;a++)t.filters.push(this.filters[a].toJSON());return t.biases=this.biases.toJSON(),t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.num_inputs=t.num_inputs,this.l1_decay_mul=void 0!==t.l1_decay_mul?t.l1_decay_mul:1,this.l2_decay_mul=void 0!==t.l2_decay_mul?t.l2_decay_mul:1,this.filters=[];for(var a=0;a<t.filters.length;a++)this.filters.push(i.default.fromJSON(t.filters[a]));this.biases=i.default.fromJSON(t.biases)},t}(a.default);t.default=n}),define("Net/Layers/InputLayer",["require","exports","Net/Layers/BaseLayer","Net/Utils"],function(e,t,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="input",a.in_depth=i.getopt(t,["in_depth","out_depth","depth"],0),a.in_sx=i.getopt(t,["in_sx","out_sx","sx","width"],1),a.in_sy=i.getopt(t,["in_sy","out_sy","sy","height"],1),a.updateDimensions(),a}return __extends(t,e),t.prototype.forward=function(e,t){return this.in_act=e,this.resetGradient(),this.out_act=e,this.out_act},t.prototype.backward=function(){},t}(a.default);t.default=o}),define("Net/Layers/LocalResponseNormalizationLayer",["require","exports","Net/Layers/BaseLayer"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="lrn",a.k=t.k,a.n=t.n,a.alpha=t.alpha,a.beta=t.beta,a.n%2==0&&console.warn("WARNING n should be odd for LRN layer"),a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient();var a=e.cloneAndZero();this.S_cache_=e.cloneAndZero();for(var i=Math.floor(this.n/2),o=0;o<e.sx;o++)for(var r=0;r<e.sy;r++)for(var n=0;n<e.depth;n++){for(var s=e.get(o,r,n),p=this.k,l=this.alpha/this.n,u=0,d=Math.max(0,n-i);d<=Math.min(n+i,e.depth-1);d++){var m=e.get(o,r,d);u+=m*m}var h=p+l*u;this.S_cache_.set(o,r,n,h);var f=s*Math.pow(h,-this.beta);a.set(o,r,n,f)}return this.out_act=a,this.out_act},t.prototype.backward=function(){for(var e=this.in_act,t=this.out_act,a=Math.floor(this.n/2),i=0;i<e.sx;i++)for(var o=0;o<e.sy;o++)for(var r=0;r<e.depth;r++){for(var n=this.S_cache_.get(i,o,r),s=e.get(i,o,r),p=t.get_grad(i,o,r),l=Math.pow(n,-this.beta)*p,u=2*this.alpha*this.beta/this.n*s,d=0,m=Math.max(0,r-a);m<=Math.min(r+a,e.depth-1);m++){var h=t.get(i,o,m);d+=t.get_grad(i,o,m)*h/this.S_cache_.get(i,o,m)}var f=l-u*d;e.add_grad(i,o,r,f)}},t.prototype.getDescription=function(){return e.prototype.getDescription.call(this).concat(["n "+this.n+", k "+this.k])},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.k=this.k,t.n=this.n,t.alpha=this.alpha,t.beta=this.beta,t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.k=t.k,this.n=t.n,this.alpha=t.alpha,this.beta=t.beta},t}(a.default);t.default=i}),define("Net/Layers/MaxoutLayer",["require","exports","Net/Layers/BaseLayer","Net/Vol","NumJS/_module"],function(e,t,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="maxout",a.group_size=void 0!==t.group_size?t.group_size:2,a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient(),this.switches=o.zeros(this.out_sx*this.out_sy*this.out_depth,Uint32Array);var a=this.out_depth,r=new i.default(this.out_sx,this.out_sy,this.out_depth,0);if(1===this.out_sx&&1===this.out_sy)for(h=0;h<a;h++){for(var n=h*this.group_size,s=e.w[n],p=0,l=1;l<this.group_size;l++)(f=e.w[n+l])>s&&(s=f,p=l);r.w[h]=s,this.switches[h]=n+p}else for(var u=0,d=0;d<e.sx;d++)for(var m=0;m<e.sy;m++)for(var h=0;h<a;h++){for(var n=h*this.group_size,s=e.get(d,m,n),p=0,l=1;l<this.group_size;l++){var f=e.get(d,m,n+l);f>s&&(s=f,p=l)}r.set(d,m,h,s),this.switches[u]=n+p,u++}return this.out_act=r,this.out_act},t.prototype.backward=function(){var e=this.in_act,t=this.out_act,a=this.out_depth;if(1===this.out_sx&&1===this.out_sy)for(n=0;n<a;n++){s=t.dw[n];e.dw[this.switches[n]]+=s}else for(var i=0,o=0;o<t.sx;o++)for(var r=0;r<t.sy;r++)for(var n=0;n<a;n++){var s=t.get_grad(o,r,n);e.add_grad(o,r,this.switches[i],s),i++}},t.prototype.updateDimensions=function(e){e&&(this.in_sx=e[0].out_sx,this.in_sy=e[0].out_sy,this.in_depth=e[0].out_depth),this.out_sx=this.in_sx,this.out_sy=this.in_sy,this.out_depth=Math.floor(this.in_depth/this.group_size)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.group_size=this.group_size,t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.group_size=t.group_size},t}(a.default);t.default=r}),define("Net/Layers/PoolLayer",["require","exports","Net/Layers/BaseLayer","Net/Vol","Net/Utils","NumJS/_module"],function(e,t,a,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="pool",a.out_depth=t.filters,a.sx=t.sx,a.pool=o.getopt(t,["pool"],"MAX"),a.sy=o.getopt(t,["sy"],a.sx),a.stride=o.getopt(t,["stride"],1),a.pad=o.getopt(t,["pad"],0),a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient(),this.switchx=r.zeros(this.out_sx*this.out_sy*this.out_depth),this.switchy=r.zeros(this.out_sx*this.out_sy*this.out_depth);var a=new i.default(this.out_sx,this.out_sy,this.out_depth,0);if("AVE"===this.pool){this.sx,this.sy;for(var o=0;o<this.out_depth;++o)for(var n=0;n<this.out_sx;++n)for(var s=0;s<this.out_sy;++s){var p=0,l=n*this.stride-this.pad,u=s*this.stride-this.pad,d=Math.min(l+this.sx,e.sx+this.pad),m=Math.min(u+this.sy,e.sy+this.pad);l=Math.max(l,0),u=Math.max(u,0);for(var h=((d=Math.min(d,e.sx))-l)*((m=Math.min(m,e.sy))-u),f=l;f<d;++f)for(var y=u;y<m;++y)p+=e.get(f,y,o);a.set(n,s,o,p/h)}}else for(var _=0,c=0;c<this.out_depth;++c)for(var v=-this.pad,g=-this.pad,w=0;w<this.out_sx;v+=this.stride,w++){g=-this.pad;for(var x=0;x<this.out_sy;g+=this.stride,x++){for(var P=-99999,N=-1,b=-1,L=0;L<this.sx;++L)for(var S=0;S<this.sy;++S){var O=g+S,M=v+L;if(O>=0&&O<e.sy&&M>=0&&M<e.sx){var A=e.get(M,O,c);A>P&&(P=A,N=M,b=O)}}this.switchx[_]=N,this.switchy[_]=b,_++,a.set(w,x,c,P)}}return this.out_act=a,this.out_act},t.prototype.backward=function(){var e=this.in_act;this.out_act;if("AVE"===this.pool);else for(var t=0,a=0;a<this.out_depth;++a){this.pad;for(var i=0;i<this.out_sx;this.stride,i++){this.pad;for(var o=0;o<this.out_sy;this.stride,o++){var r=this.out_act.get_grad(i,o,a);e.add_grad(this.switchx[t],this.switchy[t],a,r),t++}}}},t.prototype.updateDimensions=function(e){e&&(this.in_sx=e[0].out_sx,this.in_sy=e[0].out_sy,this.in_depth=e[0].out_depth);var t=this.getOutputShape();this.out_sx=t[1],this.out_sy=t[2],this.out_depth=this.in_depth},t.prototype.getOutputShape=function(){return[this.out_depth,Math.ceil((this.in_sx+2*this.pad-this.sx)/this.stride+1),Math.ceil((this.in_sy+2*this.pad-this.sy)/this.stride+1)]},t.prototype.getDescription=function(){return[this.pool+" "+this.layer_type.toUpperCase(),this.name,[this.sy,this.sx].join("x")+" Stride "+this.stride+" Pad "+this.pad]},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.sx=this.sx,t.sy=this.sy,t.stride=this.stride,t.pool=this.pool,t.in_depth=this.in_depth,t.pad=this.pad,t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.pool=void 0!==t.pool?t.pool:"MAX",this.sx=t.sx,this.sy=t.sy,this.stride=t.stride,this.in_depth=t.in_depth,this.pad=void 0!==t.pad?t.pad:0,this.switchx=r.zeros(this.out_sx*this.out_sy*this.out_depth,Uint32Array),this.switchy=r.zeros(this.out_sx*this.out_sy*this.out_depth,Uint32Array)},t}(a.default);t.default=n}),define("Net/Layers/RegressionLayer",["require","exports","Net/Layers/BaseLayer"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="regression",a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){return this.in_act=e,this.resetGradient(),this.out_act=e,e},t.prototype.backward=function(e){var t=this.in_act,a=0;if(e instanceof Float32Array)for(i=0;i<this.out_depth;i++){r=t.w[i]-e[i];t.dw[i]=r,a+=.5*r*r}else if("number"==typeof e){r=t.w[0]-e;t.dw[0]=r,a+=.5*r*r}else{var i=e.dim,o=e.val,r=t.w[i]-o;t.dw[i]=r,a+=.5*r*r}return a},t.prototype.updateDimensions=function(e){e&&(this.in_sx=e[0].out_sx,this.in_sy=e[0].out_sy,this.in_depth=e[0].out_depth),this.num_inputs=this.in_sx*this.in_sy*this.in_depth,this.out_depth=this.num_inputs},t.prototype.getOutputShape=function(){return[this.out_depth,1,1]},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.num_inputs=this.num_inputs,t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.num_inputs=t.num_inputs},t}(a.default);t.default=i}),define("Net/Layers/ReluLayer",["require","exports","Net/Layers/BaseLayer"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="relu",a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient();for(var a=e.clone(),i=e.w.length,o=a.w,r=0;r<i;r++)o[r]<0&&(o[r]=0);return this.out_act=a,this.out_act},t.prototype.backward=function(){for(var e=this.in_act,t=this.out_act,a=e.w.length,i=0;i<a;i++)t.w[i]<=0?e.dw[i]=0:e.dw[i]+=t.dw[i]},t}(a.default);t.default=i}),define("Net/Layers/SVMLayer",["require","exports","Net/Layers/BaseLayer"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="svm",a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){return this.in_act=e,this.resetGradient(),this.out_act=e,e},t.prototype.backward=function(e){for(var t=this.in_act,a=t.w[e],i=0,o=0;o<this.out_depth;o++)if(e!==o){var r=-a+t.w[o]+1;r>0&&(t.dw[o]+=1,t.dw[e]-=1,i+=r)}return i},t.prototype.updateDimensions=function(e){e&&(this.in_sx=e[0].out_sx,this.in_sy=e[0].out_sy,this.in_depth=e[0].out_depth),this.num_inputs=this.in_sx*this.in_sy*this.in_depth,this.out_depth=this.num_inputs},t.prototype.getOutputShape=function(){return[this.out_depth,1,1]},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.num_inputs=this.num_inputs,t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.num_inputs=t.num_inputs},t}(a.default);t.default=i}),define("Net/Layers/SigmoidLayer",["require","exports","Net/Layers/BaseLayer"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="sigmoid",a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient();for(var a=e.cloneAndZero(),i=e.w.length,o=a.w,r=e.w,n=0;n<i;n++)o[n]=1/(1+Math.exp(-r[n]));return this.out_act=a,this.out_act},t.prototype.backward=function(){for(var e=this.in_act,t=this.out_act,a=e.w.length,i=0;i<a;i++){var o=t.w[i];e.dw[i]+=o*(1-o)*t.dw[i]}},t}(a.default);t.default=i}),define("Net/Layers/SoftmaxLayer",["require","exports","Net/Layers/BaseLayer","Net/Vol","NumJS/_module"],function(e,t,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="softmax",a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient();for(var a=new i.default(1,1,this.out_depth,0),r=e.w,n=e.w[0],s=1;s<this.out_depth;s++)r[s]>n&&(n=r[s]);for(var p=o.zeros(this.out_depth),l=0,s=0;s<this.out_depth;s++){var u=Math.exp(r[s]-n);l+=u,p[s]=u}for(s=0;s<this.out_depth;s++)p[s]/=l,a.w[s]=p[s];return this.es=p,this.out_act=a,this.out_act},t.prototype.backward=function(e){for(var t=this.in_act,a=0;a<this.out_depth;a++){var i=-((a===e?1:0)-this.es[a]);t.dw[a]+=i}return-Math.log(this.es[e])},t.prototype.updateDimensions=function(e){e&&(this.in_sx=e[0].out_sx,this.in_sy=e[0].out_sy,this.in_depth=e[0].out_depth),this.num_inputs=this.in_sx*this.in_sy*this.in_depth,this.out_depth=this.num_inputs},t.prototype.getOutputShape=function(){return[this.out_depth,1,1]},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.num_inputs=this.num_inputs,t},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.num_inputs=t.num_inputs},t}(a.default);t.default=r}),define("Net/Layers/TanhLayer",["require","exports","Net/Layers/BaseLayer","NumJS/_module"],function(e,t,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var a=e.call(this,t||{})||this;return a.layer_type="tanh",a.updateDimensions(t.pred),a}return __extends(t,e),t.prototype.forward=function(e,t){this.in_act=e,this.resetGradient();for(var a=e.cloneAndZero(),o=e.w.length,r=0;r<o;r++)a.w[r]=i.tanh(e.w[r]);return this.out_act=a,this.out_act},t.prototype.backward=function(){for(var e=this.in_act,t=this.out_act,a=e.w.length,i=0;i<a;i++){var o=t.w[i];e.dw[i]+=(1-o*o)*t.dw[i]}},t}(a.default);t.default=o}),define("Net/Layers/_module",["require","exports","Net/Layers/BaseLayer","Net/Layers/ConcatLayer","Net/Layers/ConvLayer","Net/Layers/DropoutLayer","Net/Layers/FullyConnectedLayer","Net/Layers/InputLayer","Net/Layers/LocalResponseNormalizationLayer","Net/Layers/MaxoutLayer","Net/Layers/PoolLayer","Net/Layers/RegressionLayer","Net/Layers/ReluLayer","Net/Layers/SVMLayer","Net/Layers/SigmoidLayer","Net/Layers/SoftmaxLayer","Net/Layers/TanhLayer"],function(e,t,a,i,o,r,n,s,p,l,u,d,m,h,f,y,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseLayer=a.default,t.ConcatLayer=i.default,t.ConvLayer=o.default,t.DropoutLayer=r.default,t.FullyConnectedLayer=n.default,t.InputLayer=s.default,t.LocalResponseNormalizationLayer=p.default,t.MaxoutLayer=l.default,t.PoolLayer=u.default,t.RegressionLayer=d.default,t.ReluLayer=m.default,t.SVMLayer=h.default,t.SigmoidLayer=f.default,t.SoftmaxLayer=y.default,t.TanhLayer=_.default}),define("Net/CaffeModel",["require","exports","d3","Parser/PrototxtParser","Net/Net","Net/Layers/_module"],function(e,t,a,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,a){var i=e.call(this)||this;return i.modelPath=t,i.weightPath=a,i}return __extends(t,e),t.prototype.load=function(){var e=this;return this.fetch(this.modelPath).then(function(t){return e.create(t)}).then(function(t){return e.loadWeights()})},t.prototype.fromText=function(e){var t=new i.default;return this.create(t.parseString(e)),this},t.prototype.fetch=function(e){return(new i.default).parse(e)},t.prototype.create=function(e){this.name=e.name,this.createLayers(e,e.layer||e.layers,"data"===e.input),this.createEdges()},t.prototype.caffeLayerToJs=function(e){var t,a=this,i={name:e.name,input:e.bottom,output:e.top};switch(void 0!==e.bottom&&(Array.isArray(e.bottom)?i.pred=e.bottom.map(function(e){return a.layers.get(e)}):i.pred=[this.layers.get(e.bottom)]),e.type.toLowerCase()){case"input":o=e.input_param||{};i.out_depth=+o.shape.dim[1],i.out_sx=+o.shape.dim[2],i.out_sy=+o.shape.dim[3],t=new r.InputLayer(i);break;case"conv":case"convolution":var o=e.param||{},n=e.convolution_param||{};i.sx=void 0!==n.kernel_size?+n.kernel_size:void 0,i.filters=void 0!==n.num_output?+n.num_output:void 0,i.pad=void 0!==n.pad?+n.pad:void 0,i.stride=void 0!==n.stride?+n.stride:void 0,i.l1_decay_mul=o&&o.length&&void 0!==o[0].decay_mult?+o[0].decay_mult:0,i.l2_decay_mul=o&&o.length&&void 0!==o[1].decay_mult?+o[1].decay_mult:1,i.group=void 0!==n.group?+n.group:1,t=new r.ConvLayer(i);break;case"lrn":o=e.lrn_param||{};i.k=void 0!==o.k?+o.k:1,i.n=void 0!==o.local_size?+o.local_size:void 0,i.alpha=void 0!==o.alpha?+o.alpha:void 0,i.beta=void 0!==o.beta?+o.beta:void 0,t=new r.LocalResponseNormalizationLayer(i);break;case"dropout":var s=e.dropout_param||{};i.drop_prob=void 0!==s.dropout_ratio?+s.dropout_ratio:void 0,t=new r.DropoutLayer(i);break;case"concat":n=e.concat_param||{};i.axis=void 0!==n.axis?+n.axis:void 0,t=new r.ConcatLayer(i);break;case"pool":case"pooling":p=e.pooling_param||{};i.pool=void 0!==p.pool?p.pool:void 0,i.sx=void 0!==p.kernel_size?+p.kernel_size:void 0,i.pad=void 0!==p.pad?+p.pad:void 0,i.stride=void 0!==p.stride?+p.stride:void 0,t=new r.PoolLayer(i);break;case"inner_product":case"innerproduct":var p=e.inner_product_param||{},o=e.param||{};i.num_neurons=void 0!==p.num_output?+p.num_output:void 0,i.l1_decay_mul=o&&o.length&&void 0!==o[0].decay_mult?+o[0].decay_mult:0,i.l2_decay_mul=o&&o.length&&void 0!==o[1].decay_mult?+o[1].decay_mult:1,t=new r.FullyConnectedLayer(i);break;case"softmax":t=new r.SoftmaxLayer(i);break;case"relu":t=new r.ReluLayer(i);break;case"sigmoid":t=new r.SigmoidLayer(i);break;case"tanh":t=new r.TanhLayer(i);break;default:return void console.error("Cannot parse layer "+e.type,e)}this.layers.set(t.name,t)},t.prototype.createLayers=function(e,t,i){var o=this;void 0===i&&(i=!1),this.layers=a.map(),i&&this.layers.set("data",new r.InputLayer({name:"data",in_depth:+e.input_dim[1],in_sy:+e.input_dim[2],in_sx:+e.input_dim[3]})),t.forEach(function(e){return o.caffeLayerToJs(e)})},t.prototype.createEdges=function(){var e=this;this.edges=[],this.layers.values().filter(function(e){return void 0!==e.input&&e.input!==e.output}).forEach(function(t){Array.isArray(t.input)?t.input.forEach(function(a){e.edges.push({from:a,to:t.output})}):e.edges.push({from:t.input,to:t.output})}),this.layers.values().filter(function(e){return void 0!==e.input&&e.input===e.output}).forEach(function(t){e.edges.filter(function(e){return e.from===t.input}).forEach(function(a){a.from=t.name,e.edges.push({from:t.input,to:t.name})})})},t.prototype.loadWeights=function(){var e=this;return this.weightPath?Promise.all(this.layers.values().filter(function(e){return"conv"==e.layer_type||"fc"==e.layer_type}).map(function(t){return Promise.all([fetch(e.weightPath+t.name+"_filter.bin").then(function(e){return e.arrayBuffer()}).then(function(e){for(var a=new Float32Array(e),i=void 0===t.num_inputs?Math.ceil(t.sx*t.sy*t.in_depth/t.conv_groups):t.num_inputs,o=0;o<t.out_depth;o++)t.filters[o].w.set(a.slice(o*i,o*i+i))}),fetch(e.weightPath+t.name+"_bias.bin").then(function(e){return e.arrayBuffer()}).then(function(e){var a=new Float32Array(e);t.biases.w.set(a)})])})):Promise.resolve()},t}(o.default);t.default=n}),define("Parser/BinaryParser",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.fetch=function(e){var t=new Request(e);return fetch(t).then(function(e){return e.arrayBuffer()})},e.prototype.parse=function(e){var t=this;return this.fetch(e).then(function(e){return t.parseBuffer(e)})},e}();t.BinaryParser=a}),define("Parser/BinaryprotoParser",["require","exports","Parser/BinaryParser","./Protobuf"],function(e,t,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.parseBuffer=function(e){var t=i.dcodeIO.ProtoBuf.newBuilder({}).import({package:"caffe",messages:[{name:"BlobShape",fields:[{rule:"repeated",type:"int64",name:"dim",id:1,options:{packed:!0}}]},{name:"BlobProto",fields:[{rule:"optional",type:"BlobShape",name:"shape",id:7},{rule:"repeated",type:"float",name:"data",id:5,options:{packed:!0}},{rule:"repeated",type:"float",name:"diff",id:6,options:{packed:!0}},{rule:"repeated",type:"double",name:"double_data",id:8,options:{packed:!0}},{rule:"repeated",type:"double",name:"double_diff",id:9,options:{packed:!0}},{rule:"optional",type:"int32",name:"num",id:1,options:{default:0}},{rule:"optional",type:"int32",name:"channels",id:2,options:{default:0}},{rule:"optional",type:"int32",name:"height",id:3,options:{default:0}},{rule:"optional",type:"int32",name:"width",id:4,options:{default:0}}]},{name:"BlobProtoVector",fields:[{rule:"repeated",type:"BlobProto",name:"blobs",id:1}]},{name:"Datum",fields:[{rule:"optional",type:"int32",name:"channels",id:1},{rule:"optional",type:"int32",name:"height",id:2},{rule:"optional",type:"int32",name:"width",id:3},{rule:"optional",type:"bytes",name:"data",id:4},{rule:"optional",type:"int32",name:"label",id:5},{rule:"repeated",type:"float",name:"float_data",id:6},{rule:"optional",type:"bool",name:"encoded",id:7,options:{default:!1}}]},{name:"FillerParameter",fields:[{rule:"optional",type:"string",name:"type",id:1,options:{default:"constant"}},{rule:"optional",type:"float",name:"value",id:2,options:{default:0}},{rule:"optional",type:"float",name:"min",id:3,options:{default:0}},{rule:"optional",type:"float",name:"max",id:4,options:{default:1}},{rule:"optional",type:"float",name:"mean",id:5,options:{default:0}},{rule:"optional",type:"float",name:"std",id:6,options:{default:1}},{rule:"optional",type:"int32",name:"sparse",id:7,options:{default:-1}},{rule:"optional",type:"VarianceNorm",name:"variance_norm",id:8,options:{default:"FAN_IN"}}],enums:[{name:"VarianceNorm",values:[{name:"FAN_IN",id:0},{name:"FAN_OUT",id:1},{name:"AVERAGE",id:2}]}]},{name:"NetParameter",fields:[{rule:"optional",type:"string",name:"name",id:1},{rule:"repeated",type:"string",name:"input",id:3},{rule:"repeated",type:"BlobShape",name:"input_shape",id:8},{rule:"repeated",type:"int32",name:"input_dim",id:4},{rule:"optional",type:"bool",name:"force_backward",id:5,options:{default:!1}},{rule:"optional",type:"NetState",name:"state",id:6},{rule:"optional",type:"bool",name:"debug_info",id:7,options:{default:!1}},{rule:"repeated",type:"LayerParameter",name:"layer",id:100},{rule:"repeated",type:"V1LayerParameter",name:"layers",id:2}]},{name:"SolverParameter",fields:[{rule:"optional",type:"string",name:"net",id:24},{rule:"optional",type:"NetParameter",name:"net_param",id:25},{rule:"optional",type:"string",name:"train_net",id:1},{rule:"repeated",type:"string",name:"test_net",id:2},{rule:"optional",type:"NetParameter",name:"train_net_param",id:21},{rule:"repeated",type:"NetParameter",name:"test_net_param",id:22},{rule:"optional",type:"NetState",name:"train_state",id:26},{rule:"repeated",type:"NetState",name:"test_state",id:27},{rule:"repeated",type:"int32",name:"test_iter",id:3},{rule:"optional",type:"int32",name:"test_interval",id:4,options:{default:0}},{rule:"optional",type:"bool",name:"test_compute_loss",id:19,options:{default:!1}},{rule:"optional",type:"bool",name:"test_initialization",id:32,options:{default:!0}},{rule:"optional",type:"float",name:"base_lr",id:5},{rule:"optional",type:"int32",name:"display",id:6},{rule:"optional",type:"int32",name:"average_loss",id:33,options:{default:1}},{rule:"optional",type:"int32",name:"max_iter",id:7},{rule:"optional",type:"int32",name:"iter_size",id:36,options:{default:1}},{rule:"optional",type:"string",name:"lr_policy",id:8},{rule:"optional",type:"float",name:"gamma",id:9},{rule:"optional",type:"float",name:"power",id:10},{rule:"optional",type:"float",name:"momentum",id:11},{rule:"optional",type:"float",name:"weight_decay",id:12},{rule:"optional",type:"string",name:"regularization_type",id:29,options:{default:"L2"}},{rule:"optional",type:"int32",name:"stepsize",id:13},{rule:"repeated",type:"int32",name:"stepvalue",id:34},{rule:"optional",type:"float",name:"clip_gradients",id:35,options:{default:-1}},{rule:"optional",type:"int32",name:"snapshot",id:14,options:{default:0}},{rule:"optional",type:"string",name:"snapshot_prefix",id:15},{rule:"optional",type:"bool",name:"snapshot_diff",id:16,options:{default:!1}},{rule:"optional",type:"SnapshotFormat",name:"snapshot_format",id:37,options:{default:"BINARYPROTO"}},{rule:"optional",type:"SolverMode",name:"solver_mode",id:17,options:{default:"GPU"}},{rule:"optional",type:"int32",name:"device_id",id:18,options:{default:0}},{rule:"optional",type:"int64",name:"random_seed",id:20,options:{default:-1}},{rule:"optional",type:"string",name:"type",id:40,options:{default:"SGD"}},{rule:"optional",type:"float",name:"delta",id:31,options:{default:1e-8}},{rule:"optional",type:"float",name:"momentum2",id:39,options:{default:.999}},{rule:"optional",type:"float",name:"rms_decay",id:38},{rule:"optional",type:"bool",name:"debug_info",id:23,options:{default:!1}},{rule:"optional",type:"bool",name:"snapshot_after_train",id:28,options:{default:!0}},{rule:"optional",type:"SolverType",name:"solver_type",id:30,options:{default:"SGD"}}],enums:[{name:"SnapshotFormat",values:[{name:"HDF5",id:0},{name:"BINARYPROTO",id:1}]},{name:"SolverMode",values:[{name:"CPU",id:0},{name:"GPU",id:1}]},{name:"SolverType",values:[{name:"SGD",id:0},{name:"NESTEROV",id:1},{name:"ADAGRAD",id:2},{name:"RMSPROP",id:3},{name:"ADADELTA",id:4},{name:"ADAM",id:5}]}]},{name:"SolverState",fields:[{rule:"optional",type:"int32",name:"iter",id:1},{rule:"optional",type:"string",name:"learned_net",id:2},{rule:"repeated",type:"BlobProto",name:"history",id:3},{rule:"optional",type:"int32",name:"current_step",id:4,options:{default:0}}]},{name:"NetState",fields:[{rule:"optional",type:"Phase",name:"phase",id:1,options:{default:"TEST"}},{rule:"optional",type:"int32",name:"level",id:2,options:{default:0}},{rule:"repeated",type:"string",name:"stage",id:3}]},{name:"NetStateRule",fields:[{rule:"optional",type:"Phase",name:"phase",id:1},{rule:"optional",type:"int32",name:"min_level",id:2},{rule:"optional",type:"int32",name:"max_level",id:3},{rule:"repeated",type:"string",name:"stage",id:4},{rule:"repeated",type:"string",name:"not_stage",id:5}]},{name:"ParamSpec",fields:[{rule:"optional",type:"string",name:"name",id:1},{rule:"optional",type:"DimCheckMode",name:"share_mode",id:2},{rule:"optional",type:"float",name:"lr_mult",id:3,options:{default:1}},{rule:"optional",type:"float",name:"decay_mult",id:4,options:{default:1}}],enums:[{name:"DimCheckMode",values:[{name:"STRICT",id:0},{name:"PERMISSIVE",id:1}]}]},{name:"LayerParameter",fields:[{rule:"optional",type:"string",name:"name",id:1},{rule:"optional",type:"string",name:"type",id:2},{rule:"repeated",type:"string",name:"bottom",id:3},{rule:"repeated",type:"string",name:"top",id:4},{rule:"optional",type:"Phase",name:"phase",id:10},{rule:"repeated",type:"float",name:"loss_weight",id:5},{rule:"repeated",type:"ParamSpec",name:"param",id:6},{rule:"repeated",type:"BlobProto",name:"blobs",id:7},{rule:"repeated",type:"bool",name:"propagate_down",id:11},{rule:"repeated",type:"NetStateRule",name:"include",id:8},{rule:"repeated",type:"NetStateRule",name:"exclude",id:9},{rule:"optional",type:"TransformationParameter",name:"transform_param",id:100},{rule:"optional",type:"LossParameter",name:"loss_param",id:101},{rule:"optional",type:"AccuracyParameter",name:"accuracy_param",id:102},{rule:"optional",type:"ArgMaxParameter",name:"argmax_param",id:103},{rule:"optional",type:"BatchNormParameter",name:"batch_norm_param",id:139},{rule:"optional",type:"BiasParameter",name:"bias_param",id:141},{rule:"optional",type:"ConcatParameter",name:"concat_param",id:104},{rule:"optional",type:"ContrastiveLossParameter",name:"contrastive_loss_param",id:105},{rule:"optional",type:"ConvolutionParameter",name:"convolution_param",id:106},{rule:"optional",type:"CropParameter",name:"crop_param",id:144},{rule:"optional",type:"DataParameter",name:"data_param",id:107},{rule:"optional",type:"DropoutParameter",name:"dropout_param",id:108},{rule:"optional",type:"DummyDataParameter",name:"dummy_data_param",id:109},{rule:"optional",type:"EltwiseParameter",name:"eltwise_param",id:110},{rule:"optional",type:"ELUParameter",name:"elu_param",id:140},{rule:"optional",type:"EmbedParameter",name:"embed_param",id:137},{rule:"optional",type:"ExpParameter",name:"exp_param",id:111},{rule:"optional",type:"FlattenParameter",name:"flatten_param",id:135},{rule:"optional",type:"HDF5DataParameter",name:"hdf5_data_param",id:112},{rule:"optional",type:"HDF5OutputParameter",name:"hdf5_output_param",id:113},{rule:"optional",type:"HingeLossParameter",name:"hinge_loss_param",id:114},{rule:"optional",type:"ImageDataParameter",name:"image_data_param",id:115},{rule:"optional",type:"InfogainLossParameter",name:"infogain_loss_param",id:116},{rule:"optional",type:"InnerProductParameter",name:"inner_product_param",id:117},{rule:"optional",type:"InputParameter",name:"input_param",id:143},{rule:"optional",type:"LogParameter",name:"log_param",id:134},{rule:"optional",type:"LRNParameter",name:"lrn_param",id:118},{rule:"optional",type:"MemoryDataParameter",name:"memory_data_param",id:119},{rule:"optional",type:"MVNParameter",name:"mvn_param",id:120},{rule:"optional",type:"ParameterParameter",name:"parameter_param",id:145},{rule:"optional",type:"PoolingParameter",name:"pooling_param",id:121},{rule:"optional",type:"PowerParameter",name:"power_param",id:122},{rule:"optional",type:"PReLUParameter",name:"prelu_param",id:131},{rule:"optional",type:"PythonParameter",name:"python_param",id:130},{rule:"optional",type:"ReductionParameter",name:"reduction_param",id:136},{rule:"optional",type:"ReLUParameter",name:"relu_param",id:123},{rule:"optional",type:"ReshapeParameter",name:"reshape_param",id:133},{rule:"optional",type:"ScaleParameter",name:"scale_param",id:142},{rule:"optional",type:"SigmoidParameter",name:"sigmoid_param",id:124},{rule:"optional",type:"SoftmaxParameter",name:"softmax_param",id:125},{rule:"optional",type:"SPPParameter",name:"spp_param",id:132},{rule:"optional",type:"SliceParameter",name:"slice_param",id:126},{rule:"optional",type:"TanHParameter",name:"tanh_param",id:127},{rule:"optional",type:"ThresholdParameter",name:"threshold_param",id:128},{rule:"optional",type:"TileParameter",name:"tile_param",id:138},{rule:"optional",type:"WindowDataParameter",name:"window_data_param",id:129}]},{name:"TransformationParameter",fields:[{rule:"optional",type:"float",name:"scale",id:1,options:{default:1}},{rule:"optional",type:"bool",name:"mirror",id:2,options:{default:!1}},{rule:"optional",type:"uint32",name:"crop_size",id:3,options:{default:0}},{rule:"optional",type:"string",name:"mean_file",id:4},{rule:"repeated",type:"float",name:"mean_value",id:5},{rule:"optional",type:"bool",name:"force_color",id:6,options:{default:!1}},{rule:"optional",type:"bool",name:"force_gray",id:7,options:{default:!1}}]},{name:"LossParameter",fields:[{rule:"optional",type:"int32",name:"ignore_label",id:1},{rule:"optional",type:"NormalizationMode",name:"normalization",id:3,options:{default:"VALID"}},{rule:"optional",type:"bool",name:"normalize",id:2}],enums:[{name:"NormalizationMode",values:[{name:"FULL",id:0},{name:"VALID",id:1},{name:"BATCH_SIZE",id:2},{name:"NONE",id:3}]}]},{name:"AccuracyParameter",fields:[{rule:"optional",type:"uint32",name:"top_k",id:1,options:{default:1}},{rule:"optional",type:"int32",name:"axis",id:2,options:{default:1}},{rule:"optional",type:"int32",name:"ignore_label",id:3}]},{name:"ArgMaxParameter",fields:[{rule:"optional",type:"bool",name:"out_max_val",id:1,options:{default:!1}},{rule:"optional",type:"uint32",name:"top_k",id:2,options:{default:1}},{rule:"optional",type:"int32",name:"axis",id:3}]},{name:"ConcatParameter",fields:[{rule:"optional",type:"int32",name:"axis",id:2,options:{default:1}},{rule:"optional",type:"uint32",name:"concat_dim",id:1,options:{default:1}}]},{name:"BatchNormParameter",fields:[{rule:"optional",type:"bool",name:"use_global_stats",id:1},{rule:"optional",type:"float",name:"moving_average_fraction",id:2,options:{default:.999}},{rule:"optional",type:"float",name:"eps",id:3,options:{default:1e-5}}]},{name:"BiasParameter",fields:[{rule:"optional",type:"int32",name:"axis",id:1,options:{default:1}},{rule:"optional",type:"int32",name:"num_axes",id:2,options:{default:1}},{rule:"optional",type:"FillerParameter",name:"filler",id:3}]},{name:"ContrastiveLossParameter",fields:[{rule:"optional",type:"float",name:"margin",id:1,options:{default:1}},{rule:"optional",type:"bool",name:"legacy_version",id:2,options:{default:!1}}]},{name:"ConvolutionParameter",fields:[{rule:"optional",type:"uint32",name:"num_output",id:1},{rule:"optional",type:"bool",name:"bias_term",id:2,options:{default:!0}},{rule:"repeated",type:"uint32",name:"pad",id:3},{rule:"repeated",type:"uint32",name:"kernel_size",id:4},{rule:"repeated",type:"uint32",name:"stride",id:6},{rule:"repeated",type:"uint32",name:"dilation",id:18},{rule:"optional",type:"uint32",name:"pad_h",id:9,options:{default:0}},{rule:"optional",type:"uint32",name:"pad_w",id:10,options:{default:0}},{rule:"optional",type:"uint32",name:"kernel_h",id:11},{rule:"optional",type:"uint32",name:"kernel_w",id:12},{rule:"optional",type:"uint32",name:"stride_h",id:13},{rule:"optional",type:"uint32",name:"stride_w",id:14},{rule:"optional",type:"uint32",name:"group",id:5,options:{default:1}},{rule:"optional",type:"FillerParameter",name:"weight_filler",id:7},{rule:"optional",type:"FillerParameter",name:"bias_filler",id:8},{rule:"optional",type:"Engine",name:"engine",id:15,options:{default:"DEFAULT"}},{rule:"optional",type:"int32",name:"axis",id:16,options:{default:1}},{rule:"optional",type:"bool",name:"force_nd_im2col",id:17,options:{default:!1}}],enums:[{name:"Engine",values:[{name:"DEFAULT",id:0},{name:"CAFFE",id:1},{name:"CUDNN",id:2}]}]},{name:"CropParameter",fields:[{rule:"optional",type:"int32",name:"axis",id:1,options:{default:2}},{rule:"repeated",type:"uint32",name:"offset",id:2}]},{name:"DataParameter",fields:[{rule:"optional",type:"string",name:"source",id:1},{rule:"optional",type:"uint32",name:"batch_size",id:4},{rule:"optional",type:"uint32",name:"rand_skip",id:7,options:{default:0}},{rule:"optional",type:"DB",name:"backend",id:8,options:{default:"LEVELDB"}},{rule:"optional",type:"float",name:"scale",id:2,options:{default:1}},{rule:"optional",type:"string",name:"mean_file",id:3},{rule:"optional",type:"uint32",name:"crop_size",id:5,options:{default:0}},{rule:"optional",type:"bool",name:"mirror",id:6,options:{default:!1}},{rule:"optional",type:"bool",name:"force_encoded_color",id:9,options:{default:!1}},{rule:"optional",type:"uint32",name:"prefetch",id:10,options:{default:4}}],enums:[{name:"DB",values:[{name:"LEVELDB",id:0},{name:"LMDB",id:1}]}]},{name:"DropoutParameter",fields:[{rule:"optional",type:"float",name:"dropout_ratio",id:1,options:{default:.5}}]},{name:"DummyDataParameter",fields:[{rule:"repeated",type:"FillerParameter",name:"data_filler",id:1},{rule:"repeated",type:"BlobShape",name:"shape",id:6},{rule:"repeated",type:"uint32",name:"num",id:2},{rule:"repeated",type:"uint32",name:"channels",id:3},{rule:"repeated",type:"uint32",name:"height",id:4},{rule:"repeated",type:"uint32",name:"width",id:5}]},{name:"EltwiseParameter",fields:[{rule:"optional",type:"EltwiseOp",name:"operation",id:1,options:{default:"SUM"}},{rule:"repeated",type:"float",name:"coeff",id:2},{rule:"optional",type:"bool",name:"stable_prod_grad",id:3,options:{default:!0}}],enums:[{name:"EltwiseOp",values:[{name:"PROD",id:0},{name:"SUM",id:1},{name:"MAX",id:2}]}]},{name:"ELUParameter",fields:[{rule:"optional",type:"float",name:"alpha",id:1,options:{default:1}}]},{name:"EmbedParameter",fields:[{rule:"optional",type:"uint32",name:"num_output",id:1},{rule:"optional",type:"uint32",name:"input_dim",id:2},{rule:"optional",type:"bool",name:"bias_term",id:3,options:{default:!0}},{rule:"optional",type:"FillerParameter",name:"weight_filler",id:4},{rule:"optional",type:"FillerParameter",name:"bias_filler",id:5}]},{name:"ExpParameter",fields:[{rule:"optional",type:"float",name:"base",id:1,options:{default:-1}},{rule:"optional",type:"float",name:"scale",id:2,options:{default:1}},{rule:"optional",type:"float",name:"shift",id:3,options:{default:0}}]},{name:"FlattenParameter",fields:[{rule:"optional",type:"int32",name:"axis",id:1,options:{default:1}},{rule:"optional",type:"int32",name:"end_axis",id:2,options:{default:-1}}]},{name:"HDF5DataParameter",fields:[{rule:"optional",type:"string",name:"source",id:1},{rule:"optional",type:"uint32",name:"batch_size",id:2},{rule:"optional",type:"bool",name:"shuffle",id:3,options:{default:!1}}]},{name:"HDF5OutputParameter",fields:[{rule:"optional",type:"string",name:"file_name",id:1}]},{name:"HingeLossParameter",fields:[{rule:"optional",type:"Norm",name:"norm",id:1,options:{default:"L1"}}],enums:[{name:"Norm",values:[{name:"L1",id:1},{name:"L2",id:2}]}]},{name:"ImageDataParameter",fields:[{rule:"optional",type:"string",name:"source",id:1},{rule:"optional",type:"uint32",name:"batch_size",id:4,options:{default:1}},{rule:"optional",type:"uint32",name:"rand_skip",id:7,options:{default:0}},{rule:"optional",type:"bool",name:"shuffle",id:8,options:{default:!1}},{rule:"optional",type:"uint32",name:"new_height",id:9,options:{default:0}},{rule:"optional",type:"uint32",name:"new_width",id:10,options:{default:0}},{rule:"optional",type:"bool",name:"is_color",id:11,options:{default:!0}},{rule:"optional",type:"float",name:"scale",id:2,options:{default:1}},{rule:"optional",type:"string",name:"mean_file",id:3},{rule:"optional",type:"uint32",name:"crop_size",id:5,options:{default:0}},{rule:"optional",type:"bool",name:"mirror",id:6,options:{default:!1}},{rule:"optional",type:"string",name:"root_folder",id:12,options:{default:""}}]},{name:"InfogainLossParameter",fields:[{rule:"optional",type:"string",name:"source",id:1}]},{name:"InnerProductParameter",fields:[{rule:"optional",type:"uint32",name:"num_output",id:1},{rule:"optional",type:"bool",name:"bias_term",id:2,options:{default:!0}},{rule:"optional",type:"FillerParameter",name:"weight_filler",id:3},{rule:"optional",type:"FillerParameter",name:"bias_filler",id:4},{rule:"optional",type:"int32",name:"axis",id:5,options:{default:1}},{rule:"optional",type:"bool",name:"transpose",id:6,options:{default:!1}}]},{name:"InputParameter",fields:[{rule:"repeated",type:"BlobShape",name:"shape",id:1}]},{name:"LogParameter",fields:[{rule:"optional",type:"float",name:"base",id:1,options:{default:-1}},{rule:"optional",type:"float",name:"scale",id:2,options:{default:1}},{rule:"optional",type:"float",name:"shift",id:3,options:{default:0}}]},{name:"LRNParameter",fields:[{rule:"optional",type:"uint32",name:"local_size",id:1,options:{default:5}},{rule:"optional",type:"float",name:"alpha",id:2,options:{default:1}},{rule:"optional",type:"float",name:"beta",id:3,options:{default:.75}},{rule:"optional",type:"NormRegion",name:"norm_region",id:4,options:{default:"ACROSS_CHANNELS"}},{rule:"optional",type:"float",name:"k",id:5,options:{default:1}},{rule:"optional",type:"Engine",name:"engine",id:6,options:{default:"DEFAULT"}}],enums:[{name:"NormRegion",values:[{name:"ACROSS_CHANNELS",id:0},{name:"WITHIN_CHANNEL",id:1}]},{name:"Engine",values:[{name:"DEFAULT",id:0},{name:"CAFFE",id:1},{name:"CUDNN",id:2}]}]},{name:"MemoryDataParameter",fields:[{rule:"optional",type:"uint32",name:"batch_size",id:1},{rule:"optional",type:"uint32",name:"channels",id:2},{rule:"optional",type:"uint32",name:"height",id:3},{rule:"optional",type:"uint32",name:"width",id:4}]},{name:"MVNParameter",fields:[{rule:"optional",type:"bool",name:"normalize_variance",id:1,options:{default:!0}},{rule:"optional",type:"bool",name:"across_channels",id:2,options:{default:!1}},{rule:"optional",type:"float",name:"eps",id:3,options:{default:1e-9}}]},{name:"ParameterParameter",fields:[{rule:"optional",type:"BlobShape",name:"shape",id:1}]},{name:"PoolingParameter",fields:[{rule:"optional",type:"PoolMethod",name:"pool",id:1,options:{default:"MAX"}},{rule:"optional",type:"uint32",name:"pad",id:4,options:{default:0}},{rule:"optional",type:"uint32",name:"pad_h",id:9,options:{default:0}},{rule:"optional",type:"uint32",name:"pad_w",id:10,options:{default:0}},{rule:"optional",type:"uint32",name:"kernel_size",id:2},{rule:"optional",type:"uint32",name:"kernel_h",id:5},{rule:"optional",type:"uint32",name:"kernel_w",id:6},{rule:"optional",type:"uint32",name:"stride",id:3,options:{default:1}},{rule:"optional",type:"uint32",name:"stride_h",id:7},{rule:"optional",type:"uint32",name:"stride_w",id:8},{rule:"optional",type:"Engine",name:"engine",id:11,options:{default:"DEFAULT"}},{rule:"optional",type:"bool",name:"global_pooling",id:12,options:{default:!1}}],enums:[{name:"PoolMethod",values:[{name:"MAX",id:0},{name:"AVE",id:1},{name:"STOCHASTIC",id:2}]},{name:"Engine",values:[{name:"DEFAULT",id:0},{name:"CAFFE",id:1},{name:"CUDNN",id:2}]}]},{name:"PowerParameter",fields:[{rule:"optional",type:"float",name:"power",id:1,options:{default:1}},{rule:"optional",type:"float",name:"scale",id:2,options:{default:1}},{rule:"optional",type:"float",name:"shift",id:3,options:{default:0}}]},{name:"PythonParameter",fields:[{rule:"optional",type:"string",name:"module",id:1},{rule:"optional",type:"string",name:"layer",id:2},{rule:"optional",type:"string",name:"param_str",id:3,options:{default:""}},{rule:"optional",type:"bool",name:"share_in_parallel",id:4,options:{default:!1}}]},{name:"ReductionParameter",fields:[{rule:"optional",type:"ReductionOp",name:"operation",id:1,options:{default:"SUM"}},{rule:"optional",type:"int32",name:"axis",id:2,options:{default:0}},{rule:"optional",type:"float",name:"coeff",id:3,options:{default:1}}],enums:[{name:"ReductionOp",values:[{name:"SUM",id:1},{name:"ASUM",id:2},{name:"SUMSQ",id:3},{name:"MEAN",id:4}]}]},{name:"ReLUParameter",fields:[{rule:"optional",type:"float",name:"negative_slope",id:1,options:{default:0}},{rule:"optional",type:"Engine",name:"engine",id:2,options:{default:"DEFAULT"}}],enums:[{name:"Engine",values:[{name:"DEFAULT",id:0},{name:"CAFFE",id:1},{name:"CUDNN",id:2}]}]},{name:"ReshapeParameter",fields:[{rule:"optional",type:"BlobShape",name:"shape",id:1},{rule:"optional",type:"int32",name:"axis",id:2,options:{default:0}},{rule:"optional",type:"int32",name:"num_axes",id:3,options:{default:-1}}]},{name:"ScaleParameter",fields:[{rule:"optional",type:"int32",name:"axis",id:1,options:{default:1}},{rule:"optional",type:"int32",name:"num_axes",id:2,options:{default:1}},{rule:"optional",type:"FillerParameter",name:"filler",id:3},{rule:"optional",type:"bool",name:"bias_term",id:4,options:{default:!1}},{rule:"optional",type:"FillerParameter",name:"bias_filler",id:5}]},{name:"SigmoidParameter",fields:[{rule:"optional",type:"Engine",name:"engine",id:1,options:{default:"DEFAULT"}}],enums:[{name:"Engine",values:[{name:"DEFAULT",id:0},{name:"CAFFE",id:1},{name:"CUDNN",id:2}]}]},{name:"SliceParameter",fields:[{rule:"optional",type:"int32",name:"axis",id:3,options:{default:1}},{rule:"repeated",type:"uint32",name:"slice_point",id:2},{rule:"optional",type:"uint32",name:"slice_dim",id:1,options:{default:1}}]},{name:"SoftmaxParameter",fields:[{rule:"optional",type:"Engine",name:"engine",id:1,options:{default:"DEFAULT"}},{rule:"optional",type:"int32",name:"axis",id:2,options:{default:1}}],enums:[{name:"Engine",values:[{name:"DEFAULT",id:0},{name:"CAFFE",id:1},{name:"CUDNN",id:2}]}]},{name:"TanHParameter",fields:[{rule:"optional",type:"Engine",name:"engine",id:1,options:{default:"DEFAULT"}}],enums:[{name:"Engine",values:[{name:"DEFAULT",id:0},{name:"CAFFE",id:1},{name:"CUDNN",id:2}]}]},{name:"TileParameter",fields:[{rule:"optional",type:"int32",name:"axis",id:1,options:{default:1}},{rule:"optional",type:"int32",name:"tiles",id:2}]},{name:"ThresholdParameter",fields:[{rule:"optional",type:"float",name:"threshold",id:1,options:{default:0}}]},{name:"WindowDataParameter",fields:[{rule:"optional",type:"string",name:"source",id:1},{rule:"optional",type:"float",name:"scale",id:2,options:{default:1}},{rule:"optional",type:"string",name:"mean_file",id:3},{rule:"optional",type:"uint32",name:"batch_size",id:4},{rule:"optional",type:"uint32",name:"crop_size",id:5,options:{default:0}},{rule:"optional",type:"bool",name:"mirror",id:6,options:{default:!1}},{rule:"optional",type:"float",name:"fg_threshold",id:7,options:{default:.5}},{rule:"optional",type:"float",name:"bg_threshold",id:8,options:{default:.5}},{rule:"optional",type:"float",name:"fg_fraction",id:9,options:{default:.25}},{rule:"optional",type:"uint32",name:"context_pad",id:10,options:{default:0}},{rule:"optional",type:"string",name:"crop_mode",id:11,options:{default:"warp"}},{rule:"optional",type:"bool",name:"cache_images",id:12,options:{default:!1}},{rule:"optional",type:"string",name:"root_folder",id:13,options:{default:""}}]},{name:"SPPParameter",fields:[{rule:"optional",type:"uint32",name:"pyramid_height",id:1},{rule:"optional",type:"PoolMethod",name:"pool",id:2,options:{default:"MAX"}},{rule:"optional",type:"Engine",name:"engine",id:6,options:{default:"DEFAULT"}}],enums:[{name:"PoolMethod",values:[{name:"MAX",id:0},{name:"AVE",id:1},{name:"STOCHASTIC",id:2}]},{name:"Engine",values:[{name:"DEFAULT",id:0},{name:"CAFFE",id:1},{name:"CUDNN",id:2}]}]},{name:"V1LayerParameter",fields:[{rule:"repeated",type:"string",name:"bottom",id:2},{rule:"repeated",type:"string",name:"top",id:3},{rule:"optional",type:"string",name:"name",id:4},{rule:"repeated",type:"NetStateRule",name:"include",id:32},{rule:"repeated",type:"NetStateRule",name:"exclude",id:33},{rule:"optional",type:"LayerType",name:"type",id:5},{rule:"repeated",type:"BlobProto",name:"blobs",id:6},{rule:"repeated",type:"string",name:"param",id:1001},{rule:"repeated",type:"DimCheckMode",name:"blob_share_mode",id:1002},{rule:"repeated",type:"float",name:"blobs_lr",id:7},{rule:"repeated",type:"float",name:"weight_decay",id:8},{rule:"repeated",type:"float",name:"loss_weight",id:35},{rule:"optional",type:"AccuracyParameter",name:"accuracy_param",id:27},{rule:"optional",type:"ArgMaxParameter",name:"argmax_param",id:23},{rule:"optional",type:"ConcatParameter",name:"concat_param",id:9},{rule:"optional",type:"ContrastiveLossParameter",name:"contrastive_loss_param",id:40},{rule:"optional",type:"ConvolutionParameter",name:"convolution_param",id:10},{rule:"optional",type:"DataParameter",name:"data_param",id:11},{rule:"optional",type:"DropoutParameter",name:"dropout_param",id:12},{rule:"optional",type:"DummyDataParameter",name:"dummy_data_param",id:26},{rule:"optional",type:"EltwiseParameter",name:"eltwise_param",id:24},{rule:"optional",type:"ExpParameter",name:"exp_param",id:41},{rule:"optional",type:"HDF5DataParameter",name:"hdf5_data_param",id:13},{rule:"optional",type:"HDF5OutputParameter",name:"hdf5_output_param",id:14},{rule:"optional",type:"HingeLossParameter",name:"hinge_loss_param",id:29},{rule:"optional",type:"ImageDataParameter",name:"image_data_param",id:15},{rule:"optional",type:"InfogainLossParameter",name:"infogain_loss_param",id:16},{rule:"optional",type:"InnerProductParameter",name:"inner_product_param",id:17},{rule:"optional",type:"LRNParameter",name:"lrn_param",id:18},{rule:"optional",type:"MemoryDataParameter",name:"memory_data_param",id:22},{rule:"optional",type:"MVNParameter",name:"mvn_param",id:34},{rule:"optional",type:"PoolingParameter",name:"pooling_param",id:19},{rule:"optional",type:"PowerParameter",name:"power_param",id:21},{rule:"optional",type:"ReLUParameter",name:"relu_param",id:30},{rule:"optional",type:"SigmoidParameter",name:"sigmoid_param",id:38},{rule:"optional",type:"SoftmaxParameter",name:"softmax_param",id:39},{rule:"optional",type:"SliceParameter",name:"slice_param",id:31},{rule:"optional",type:"TanHParameter",name:"tanh_param",id:37},{rule:"optional",type:"ThresholdParameter",name:"threshold_param",id:25},{rule:"optional",type:"WindowDataParameter",name:"window_data_param",id:20},{rule:"optional",type:"TransformationParameter",name:"transform_param",id:36},{rule:"optional",type:"LossParameter",name:"loss_param",id:42},{rule:"optional",type:"V0LayerParameter",name:"layer",id:1}],enums:[{name:"LayerType",values:[{name:"NONE",id:0},{name:"ABSVAL",id:35},{name:"ACCURACY",id:1},{name:"ARGMAX",id:30},{name:"BNLL",id:2},{name:"CONCAT",id:3},{name:"CONTRASTIVE_LOSS",id:37},{name:"CONVOLUTION",id:4},{name:"DATA",id:5},{name:"DECONVOLUTION",id:39},{name:"DROPOUT",id:6},{name:"DUMMY_DATA",id:32},{name:"EUCLIDEAN_LOSS",id:7},{name:"ELTWISE",id:25},{name:"EXP",id:38},{name:"FLATTEN",id:8},{name:"HDF5_DATA",id:9},{name:"HDF5_OUTPUT",id:10},{name:"HINGE_LOSS",id:28},{name:"IM2COL",id:11},{name:"IMAGE_DATA",id:12},{name:"INFOGAIN_LOSS",id:13},{name:"INNER_PRODUCT",id:14},{name:"LRN",id:15},{name:"MEMORY_DATA",id:29},{name:"MULTINOMIAL_LOGISTIC_LOSS",id:16},{name:"MVN",id:34},{name:"POOLING",id:17},{name:"POWER",id:26},{name:"RELU",id:18},{name:"SIGMOID",id:19},{name:"SIGMOID_CROSS_ENTROPY_LOSS",id:27},{name:"SILENCE",id:36},{name:"SOFTMAX",id:20},{name:"SOFTMAX_LOSS",id:21},{name:"SPLIT",id:22},{name:"SLICE",id:33},{name:"TANH",id:23},{name:"WINDOW_DATA",id:24},{name:"THRESHOLD",id:31}]},{name:"DimCheckMode",values:[{name:"STRICT",id:0},{name:"PERMISSIVE",id:1}]}]},{name:"V0LayerParameter",fields:[{rule:"optional",type:"string",name:"name",id:1},{rule:"optional",type:"string",name:"type",id:2},{rule:"optional",type:"uint32",name:"num_output",id:3},{rule:"optional",type:"bool",name:"biasterm",id:4,options:{default:!0}},{rule:"optional",type:"FillerParameter",name:"weight_filler",id:5},{rule:"optional",type:"FillerParameter",name:"bias_filler",id:6},{rule:"optional",type:"uint32",name:"pad",id:7,options:{default:0}},{rule:"optional",type:"uint32",name:"kernelsize",id:8},{rule:"optional",type:"uint32",name:"group",id:9,options:{default:1}},{rule:"optional",type:"uint32",name:"stride",id:10,options:{default:1}},{rule:"optional",type:"PoolMethod",name:"pool",id:11,options:{default:"MAX"}},{rule:"optional",type:"float",name:"dropout_ratio",id:12,options:{default:.5}},{rule:"optional",type:"uint32",name:"local_size",id:13,options:{default:5}},{rule:"optional",type:"float",name:"alpha",id:14,options:{default:1}},{rule:"optional",type:"float",name:"beta",id:15,options:{default:.75}},{rule:"optional",type:"float",name:"k",id:22,options:{default:1}},{rule:"optional",type:"string",name:"source",id:16},{rule:"optional",type:"float",name:"scale",id:17,options:{default:1}},{rule:"optional",type:"string",name:"meanfile",id:18},{rule:"optional",type:"uint32",name:"batchsize",id:19},{rule:"optional",type:"uint32",name:"cropsize",id:20,options:{default:0}},{rule:"optional",type:"bool",name:"mirror",id:21,options:{default:!1}},{rule:"repeated",type:"BlobProto",name:"blobs",id:50},{rule:"repeated",type:"float",name:"blobs_lr",id:51},{rule:"repeated",type:"float",name:"weight_decay",id:52},{rule:"optional",type:"uint32",name:"rand_skip",id:53,options:{default:0}},{rule:"optional",type:"float",name:"det_fg_threshold",id:54,options:{default:.5}},{rule:"optional",type:"float",name:"det_bg_threshold",id:55,options:{default:.5}},{rule:"optional",type:"float",name:"det_fg_fraction",id:56,options:{default:.25}},{rule:"optional",type:"uint32",name:"det_context_pad",id:58,options:{default:0}},{rule:"optional",type:"string",name:"det_crop_mode",id:59,options:{default:"warp"}},{rule:"optional",type:"int32",name:"new_num",id:60,options:{default:0}},{rule:"optional",type:"int32",name:"new_channels",id:61,options:{default:0}},{rule:"optional",type:"int32",name:"new_height",id:62,options:{default:0}},{rule:"optional",type:"int32",name:"new_width",id:63,options:{default:0}},{rule:"optional",type:"bool",name:"shuffle_images",id:64,options:{default:!1}},{rule:"optional",type:"uint32",name:"concat_dim",id:65,options:{default:1}},{rule:"optional",type:"HDF5OutputParameter",name:"hdf5_output_param",id:1001}],enums:[{name:"PoolMethod",values:[{name:"MAX",id:0},{name:"AVE",id:1},{name:"STOCHASTIC",id:2}]}]},{name:"PReLUParameter",fields:[{rule:"optional",type:"FillerParameter",name:"filler",id:1},{rule:"optional",type:"bool",name:"channel_shared",id:2,options:{default:!1}}]}],enums:[{name:"Phase",values:[{name:"TRAIN",id:0},{name:"TEST",id:1}]}]}).build();return this.parseProto(e,t.caffe)},t}(a.BinaryParser);t.BinaryprotoParser=o}),define("Parser/BlobProtoParser",["require","exports","Parser/BinaryprotoParser","Net/Vol"],function(e,t,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.parseProto=function(e,t){for(var a=t.BlobProto.decode(e),o=a.width,r=a.height,n=a.channels,s=a.data,p=new i.default(o,r,n,0),l=0;l<n;l++)for(var u=0;u<r;u++)for(var d=0;d<o;d++){var m=(r*l+u)*o+d;p.set(d,u,l,s[m])}return p},t}(a.BinaryprotoParser);t.default=o}),define("Utils/ActivationDrawer",["require","exports","d3","Net/Net","ImgJS/Image"],function(e,t,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.render=function(e,t,i,r,n){void 0===t&&(t=!0);var s=a.select(e);s.selectAll("*").remove(),this.layerIterator(function(e,a){if(t||0!=a){s.append("h5").text(e.name);for(var r=s.append("div").attr("class","net-layer").append("div").attr("class","net-vis"),n=(r.append("div").attr("class","net-weights"),r.append("div").attr("class","net-activations")),p=0,l=e.out_act.depth;p<l;++p){if(i&&p>=i)return;var u=n.append("canvas"),d=e.out_act;o.default.fromFilter(d,p,1).render(u[0][0])}}})},t.fromNet=function(e){var a=new t;return a.layers=e.layers,a.edges=e.edges,a},t}(i.default);t.default=r}),define("Utils/GraphDrawer",["require","exports","d3","dagre-d3","Net/Net"],function(e,t,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.render=function(e,t,o){var r=new i.render;this.graph=this.createGraph(),this.$elem=a.select(e),this.$elem.selectAll("*").remove(),this.$svg=this.$elem.append("svg"),this.$g=this.$svg.append("g"),r(this.$g,this.graph),this.width=t||this.graph.graph().width,this.height=o||this.graph.graph().height;var n=(this.width-this.graph.graph().width)/2;return this.$g.attr("transform","translate("+n+")"),this.$svg.attr("width",this.width),this.$svg.attr("height",this.height),this},t.prototype.fit=function(){return this.$svg.attr("viewBox","0 0 "+this.graph.graph().width+" "+this.graph.graph().height),this},t.prototype.rotate=function(){var e=(this.width-this.graph.graph().width)/2;return this.$g.attr("transform","rotate(270) translate("+e+")"),this.$svg.attr("viewBox","0 0 "+this.graph.graph().height+" "+this.graph.graph().width),this},t.prototype.createGraph=function(){var e=this,t=(new i.graphlib.Graph).setGraph({}).setDefaultEdgeLabel(function(){return""});return this.layerIterator(function(e,a,i){t.setNode(e.name,{labelType:"html",label:e.getDescription().join("<br>"),class:"layer-"+e.layer_type})}),t.nodes().forEach(function(e){var a=t.node(e);a.rx=a.ry=5}),this.edges.filter(function(e){return void 0!==e.from&&void 0!==e.to}).forEach(function(a){t.setEdge(a.from,a.to,{label:e.layers.get(a.from).getOutputShape().join("x")})}),t},t.fromNet=function(e){var a=new t;return a.layers=e.layers,a.edges=e.edges,a},t}(o.default);t.default=r});